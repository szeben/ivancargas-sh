<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template id="template_tax_withholding_iva">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <div class="page">
                        <t t-if="o.withholding_iva and o.withholding_iva != 0.0">
                            <style>
                                table, td, th {
                                    border-collapse: collapse;
                                    margin-left: auto;
                                    margin-right: auto;
                                }

                                .full-borders td {
                                    border: 1px solid black;
                                }
                            </style>
                            <t t-set="company_name" t-value="res_company.name.upper()" />
                            <t t-set="vat" t-value="res_company.vat.upper() if res_company.vat else 'XXXXX'" />
                            <t t-set="vendor_name" t-value="o.partner_id.name.upper()" />
                            <t t-set="vendor_vat" t-value="o.partner_id.vat.upper() if o.partner_id.vat else 'XXXXX'" />
                            <t t-set="number_withholding" t-value="o.date.strftime('%Y%m') + str(o.sequence_number).rjust(8, '0')" />
                            <t t-set="total_purchase" t-value="o.format_lang(o.amount_total + o.withholding_iva + (o.withholding_islr or 0.0))" />
                            <t t-set="amount_base" t-value="o.format_lang(o.amount_untaxed)" />
                            <t t-set="aliquot" t-value="o.format_lang(o.invoice_tax_id.withholding_amount)" />
                            <t t-set="amount_tax" t-value="o.format_lang(o.amount_tax + o.withholding_iva)" />
                            <t t-set="amount_withholding" t-value="o.format_lang(o.withholding_iva)" />
                            <t t-set="amount_total" t-value="o.format_lang(o.amount_total + (o.withholding_islr or 0.0))" />
                            <t t-set="invoice_control_number" t-value="o.invoice_control_number or 'ID %i' % o.id" />
                            <t t-set="reference_number" t-value="o.reference_number or o.name" />
                            <t t-set="now" t-value="context_timestamp(datetime.datetime.now())" />
                            <table style="width: 100%;">
                                <tbody>
                                    <tr style="border-top: 1px solid black; border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="15">
                                            <u>
                                                <b>COMPROBANTE DE RETENCION DEL IMPUESTO AL VALOR AGREGADO (I.V.A.):</b>
                                            </u>
                                        </td>
                                    </tr>
                                    <tr style="border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="15" style="text-align: center; font-size: small;">
                                            (Decreto con Rango, Valor y Fuerza de Ley que establece el Impuesto al Valor Agregado. Art.11.
                                            "La Administración Tributaria podrá designar como responsables del pago del impuesto, en calidad
                                            de agentes de retención, a quienes por sus funciones públicas o por razón de sus actividades
                                            privadas intervengan en operaciones gravadas con el impuesto establecido en este Decreto con
                                            Rango, Valor y Fuerza de Ley ...") (Gaceta oficial N° 6152 Extraordinario del 18 de noviembre
                                            de 2014, Decreto 1.436)
                                        </td>
                                    </tr>
                                    <tr style="border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="15" style="text-align: center; font-size: small;">
                                        Providencia Administrativa Nº SNAT-2015-0049 del 10-08-2015
                                        </td>
                                    </tr>
                                    <tr style="border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="5"></td>
                                        <td colspan="3">Nro de Comprobante de</td>
                                        <td colspan="2">
                                            <b t-out="number_withholding" />
                                        </td>
                                        <td></td>
                                        <td colspan="2">Fecha de Emisión:</td>
                                        <td colspan="2">
                                            <b t-out="now.strftime('%d/%m/%Y')" />
                                        </td>
                                    </tr>
                                    <tr style="border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="5">Nombre o Razón Social del Agente de Retención:</td>
                                        <td colspan="5" style="text-align: center;">Registro de Información Físcal del Agente de Retención:</td>
                                        <td></td>
                                        <td colspan="3" style="text-align: center;">Período Físcal:</td>
                                        <td></td>
                                    </tr>
                                    <tr style="border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="5">
                                            <b t-out="company_name" />
                                        </td>
                                        <td colspan="5" style="text-align: center;">
                                            <b t-out="vat" />
                                        </td>
                                        <td></td>
                                        <td style="text-align: center;">Año:</td>
                                        <td></td>
                                        <td style="text-align: center;">Mes:</td>
                                        <td></td>
                                    </tr>
                                    <tr style="border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="11"></td>
                                        <td style="text-align: center;">
                                            <b t-out="o.invoice_date.year" />
                                        </td>
                                        <td></td>
                                        <td style="text-align: center;">
                                            <b t-out="o.invoice_date.strftime('%m')" />
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid black; border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="15">
                                            <span>Domicilio Fiscal del Agente de Retención:</span>
                                            <br />
                                            <b t-out="' '.join([res_company.street or '', res_company.street2 or '']).upper()" />
                                        </td>
                                    </tr>
                                    <tr style="border-bottom: 1px solid black; border-right: 1px solid black; border-left: 1px solid black;">
                                        <td colspan="8">
                                            <span>Nombre o Razón Social del Sujeto Retenido:</span>
                                            <br />
                                            <b t-out="vendor_name" />
                                        </td>
                                        <td colspan="7" style="text-align: center;">
                                            <span>Número de RIF del Proveedor:</span>
                                            <br />
                                            <b t-out="vendor_vat" />
                                        </td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td>Oper. Nro.</td>
                                        <td>Fecha de la Factura ND/NC</td>
                                        <td>Nro.de Retención:</td>
                                        <td>Nro de Factura:</td>
                                        <td>Nro de Control de Factura:</td>
                                        <td>Nro de Nota de Crédito:</td>
                                        <td>Nro de Nota de Débito:</td>
                                        <td>Tipo de Transacción</td>
                                        <td>Factura Afectada</td>
                                        <td>Total Compras Incluyendo IVA</td>
                                        <td>Compras sin derecho a Crédito</td>
                                        <td>Base Imponible</td>
                                        <td>% Alicuota</td>
                                        <td>Impuesto I.V.A.</td>
                                        <td>I.V.A. Retenido</td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td>
                                            <t t-out="o_index + 1" />
                                        </td>
                                        <td>
                                            <span t-field="o.invoice_date_due"/>
                                        </td>
                                        <td>
                                            <t t-out="number_withholding" />
                                        </td>
                                        <td>
                                            <t t-out="reference_number" />
                                        </td>
                                        <td>
                                            <t t-out="invoice_control_number" />
                                        </td>
                                        <td></td>
                                        <td></td>
                                        <td>RET</td>
                                        <td></td>
                                        <td>
                                            <t t-out="total_purchase" />
                                        </td>
                                        <td>-</td>
                                        <td>
                                            <t t-out="amount_base" />
                                        </td>
                                        <td>
                                            <t t-out="aliquot" />
                                        </td>
                                        <td>
                                            <t t-out="amount_tax" />
                                        </td>
                                        <td>
                                            <t t-out="amount_withholding" />
                                        </td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td colspan="8"></td>
                                        <td>
                                            <u>
                                                <b>Totales</b>
                                            </u>
                                        </td>
                                        <td>
                                            <span t-out="total_purchase" />
                                        </td>
                                        <td>-</td>
                                        <td>
                                            <t t-out="amount_base" />
                                        </td>
                                        <td>
                                            <t t-out="aliquot" />
                                        </td>
                                        <td>
                                            <t t-out="amount_tax" />
                                        </td>
                                        <td>
                                            <t t-out="amount_withholding" />
                                        </td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td colspan="11"></td>
                                        <td colspan="3">
                                            <u>
                                                <b>Total Menos Retenciones:</b>
                                            </u>
                                        </td>
                                        <td>
                                            <b t-out="amount_total"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <br />
                            <div style="text-align: center;  align-content: center;">
                                <p>
                                    Este comprobante se emite en función a lo establecido en el artículo 16 de
                                    la Providencia Administrativa Nº SNAT-2015-0049 de fecha 10/08/2015
                                </p>
                                <br />
                                <br />
                                <table>
                                    <tbody>
                                        <tr style="text-align: center;">
                                            <td style="width: 30%; border-top: 1px solid black; border-collapse: separate;">
                                                <b>Firma del Agente de Retención:</b>
                                            </td>
                                            <td style="width: 30%;"></td>
                                            <td style="width: 30%; border-top: 1px solid black; border-collapse: separate;">
                                                <b>Fecha de Recibo y Firma del Receptor:</b>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </t>
                        <t t-else="">
                            <h1>Esta factura no tiene retención</h1>
                        </t>
                    </div>
                </t>
            </t>
        </t>
    </template>

    <template id="template_tax_withholding_islr">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <div class="page">
                        <t t-if="o.withholding_islr and o.withholding_islr != 0.0">
                            <style>
                                table, td, th {
                                    border-collapse: collapse;
                                    margin-left: auto;
                                    margin-right: auto;
                                }

                                .full-borders td {
                                    border: 1px solid black;
                                }
                            </style>
                            <t t-set="company_name" t-value="res_company.name.upper()" />
                            <t t-set="vat" t-value="res_company.vat.upper() if res_company.vat else 'XXXXX'" />
                            <t t-set="vendor_name" t-value="o.partner_id.name.upper()" />
                            <t t-set="vendor_vat" t-value="o.partner_id.vat.upper() if o.partner_id.vat else 'XXXXX'" />
                            <t t-set="now" t-value="context_timestamp(datetime.datetime.now())" />
                            <t t-set="amount_base" t-value="o.format_lang(o.amount_untaxed)" />
                            <t t-set="amount_total" t-value="o.format_lang(o.amount_total + (o.withholding_iva or 0.0))" />
                            <t t-set="amount_withholding" t-value="o.format_lang(o.withholding_islr)" />
                            <t t-set="invoice_control_number" t-value="o.invoice_control_number or 'ID %i' % o.id" />
                            <t t-set="reference_number" t-value="o.reference_number or o.name" />
                            <t t-set="line_tax" t-value="o.get_first_withholding_islr()" />
                            <t t-set="percentage" t-value="'%s %%%' % o.format_lang((line_tax and line_tax.tax_line_id.withholding_amount) or 0.0)" />
                            <table style="width: 100%;">
                                <tbody>
                                    <tr>
                                        <td colspan="10">
                                            <i t-out="company_name" />
                                            <br />
                                            <i t-out="vat" />
                                        </td>
                                    </tr>
                                    <tr style="text-align: right;">
                                        <td colspan="10">
                                            <b>
                                                <span>Periodo: </span>
                                                <span t-out="now.strftime('%Y%m')" />
                                            </b>
                                        </td>
                                    </tr>
                                    <tr style="text-align: center; font-size: large;">
                                        <td colspan="10">
                                            <b>Comprobante de Retención de Impuesto Sobre La Renta</b>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="10">
                                        Para dar cumplimiento a lo establecido en el Articulo Nº 9 del reglamento parcial de
                                        la Ley de Impuesto sobre la Renta en materia de retenciones publicado en gaceta
                                        oficial Nº 36.206 decreto Nº 1.808 de fecha 12-05-1997
                                        </td>
                                    </tr>
                                    <tr style="height: 1em;">
                                        <td colspan="10"></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td colspan="3" style="border: 1px solid black; border-collapse: separate;">
                                            <span style="font-size: small;">
                                                <i>Nombre o Razón Social Agente de Retención:</i>
                                            </span>
                                            <br />
                                            <span t-out="company_name" />
                                        </td>
                                        <td colspan="2"></td>
                                        <td colspan="3" style="border: 1px solid black; border-collapse: separate;">
                                            <span style="font-size: small;">
                                                <i>R.I.F Agente de Retención</i>
                                            </span>
                                            <br />
                                            <span t-out="vat" />
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr style="height: 1em;">
                                        <td colspan="10"></td>
                                    </tr>
                                    <tr>
                                        <td></td>
                                        <td colspan="3" style="border: 1px solid black;">
                                            <span style="font-size: small;">
                                                <i>Nombre o Razón Social del Sujeto Retenido:</i>
                                            </span>
                                            <br />
                                            <span t-out="vendor_name"/>
                                        </td>
                                        <td colspan="2"></td>
                                        <td colspan="3" style="border: 1px solid black;">
                                            <span style="font-size: small;">
                                                <i>R.I.F sujeto Retenido</i>
                                            </span>
                                            <br />
                                            <span t-out="vendor_vat" />
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr style="height: 1em;">
                                        <td colspan="10"></td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td>Operación Nº</td>
                                        <td>Fecha Factura</td>
                                        <td>Número Control</td>
                                        <td>Número de Factura</td>
                                        <td>Cod. Retención</td>
                                        <td>Base Legal Decreto 1808</td>
                                        <td>%</td>
                                        <td>Monto Bruto</td>
                                        <td>Base</td>
                                        <td>Impuesto Retenido</td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td t-out="o_index + 1" />
                                        <td>
                                            <span t-field="o.invoice_date_due" />
                                        </td>
                                        <td>
                                            <t t-out="invoice_control_number" />
                                        </td>
                                        <td>
                                            <t t-out="reference_number" />
                                        </td>
                                        <td>071</td>
                                        <td>Art 9º Nº15</td>
                                        <td>
                                            <t t-out="percentage" />
                                        </td>
                                        <td>
                                            <t t-out="amount_base" />
                                        </td>
                                        <td>
                                            <t t-out="amount_base" />
                                        </td>
                                        <td>
                                            <t t-out="amount_withholding" />
                                        </td>
                                    </tr>
                                    <tr class="full-borders">
                                        <td colspan="7" style="text-align: center;">
                                            <b>Totales</b>
                                        </td>
                                        <td>
                                            <t t-out="amount_base" />
                                        </td>
                                        <td>
                                            <t t-out="amount_base" />
                                        </td>
                                        <td>
                                            <t t-out="amount_withholding" />
                                        </td>
                                    </tr>
                                    <tr style="height: 1em;">
                                        <td colspan="10" style="padding-left: 1rem;">
                                            Tipo de Retención de Impuesto: ISLR
                                        </td>
                                    </tr>
                                    <tr style="height: 1em;">
                                        <td colspan="10" style="text-align: right;">
                                            <span>Monto a pagar a sujeto retenido: </span>
                                            <span t-out="amount_total" />
                                        </td>
                                    </tr>
                                    <tr style="text-align: center;">
                                        <td colspan="6"></td>
                                        <td colspan="3" style="word-spacing: 5em;">/ /</td>
                                        <td></td>
                                    </tr>
                                    <tr style="text-align: center; vertical-align: top; height: 5em;">
                                        <td></td>
                                        <td colspan="3" style="border-top: 1px solid black;">
                                            <span>Sello y Firma Agente de Retención</span>
                                            <br />
                                            <span>Fecha</span>
                                            <span t-out="now.strftime('%d/%m/%Y')" />
                                        </td>
                                        <td colspan="2"></td>
                                        <td colspan="3" style="border-top: 1px solid black;">
                                            Fecha Recepción Sujeto Retenido
                                        </td>
                                        <td></td>
                                    </tr>
                                    <tr style="text-align: center; vertical-align: top;">
                                        <td colspan="6"></td>
                                        <td colspan="3" style="border-top: 1px solid black;">
                                            Sello o Firma del sujeto Retenido
                                        </td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </t>
                        <t t-else="">
                            <h1>Esta factura no tiene retención</h1>
                        </t>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>